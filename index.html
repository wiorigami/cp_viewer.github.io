<!DOCTYPE html>
<html lang="en">
<head>
    <!-- 通过链接引用图标 -->
    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/wiorigami/cp_viewer.github.io/refs/heads/main/pho/ico.png">
    
    <!-- 必要的Meta标签，确保添加到主屏幕后全屏显示 -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="CP File Previewer">
    
    <title>CP File Previewer</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }
        #selectButton, #saveButton, #savePngButton, #saveJpgButton {
            padding: 15px 25px;
            font-size: 18px;
            border: none;
            border-radius: 5px;
            background-color: #007BFF;
            color: white;
            cursor: pointer;
            touch-action: manipulation;
            margin-top: 10px;
        }
        #saveButton {
            background-color: #28A745;
        }
        #savePngButton {
            background-color: #FF6347;
        }
        #saveJpgButton {
            background-color: #FFA500;
        }
    </style>
</head>
<body>
    <h1>CP File Previewer</h1>
    <input type="file" id="fileInput">
    <button id="selectButton">选择文件</button>
    <button id="saveButton">保存文件</button>
    <button id="savePngButton">导出为PNG</button>
    <button id="saveJpgButton">导出为JPG</button>
    <canvas id="canvas" style="display:none;"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // 设置导出图片的尺寸
        const exportWidth = 2000;
        const exportHeight = 2000;

        document.getElementById('savePngButton').addEventListener('click', () => {
            canvas.width = exportWidth;
            canvas.height = exportHeight;

            // 假设这里有绘制图形的逻辑
            // ctx.drawImage(...);

            canvas.toBlob((blob) => {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'exported_image.png';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            }, 'image/png');
        });

        document.getElementById('saveJpgButton').addEventListener('click', () => {
            canvas.width = exportWidth;
            canvas.height = exportHeight;

            // 假设这里有绘制图形的逻辑
            // ctx.drawImage(...);

            canvas.toBlob((blob) => {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'exported_image.jpg';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            }, 'image/jpeg');
        });
    </script>
</body>
</html>
